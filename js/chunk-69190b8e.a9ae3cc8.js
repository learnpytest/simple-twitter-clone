(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69190b8e"],{28778:function(e,t,s){},"498a":function(e,t,s){"use strict";var a=s("23e7"),r=s("58a8").trim,n=s("c8d2");a({target:"String",proto:!0,forced:n("trim")},{trim:function(){return r(this)}})},6379:function(e,t,s){},7420:function(e,t,s){},"861e":function(e,t,s){"use strict";s("28778")},"95fa":function(e,t,s){"use strict";s("7420")},a4bc:function(e,t,s){"use strict";s("6379")},b6e6:function(e,t){e.exports="data:image/png;base64,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"},b71b:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[e.showModal?s("div",{staticClass:"new-tweet-modal"},[s("NewTweetModal",{attrs:{initialShowModal:e.showModal},on:{"show-modal":e.modalToggle}})],1):e._e(),s("div",{staticClass:"public-chat-modal"}),s("div",{staticClass:"public-chat"},[s("div",{staticClass:"sidebar"},[s("Sidebar",{attrs:{initialShowModal:e.showModal},on:{"show-modal":e.modalToggle}})],1),s("div",{staticClass:"online-users"},[s("div",{staticClass:"header"},[s("div",{staticClass:"header-info"},[s("p",[e._v("上線使用者 ("+e._s(e.allUsers.length)+")")])])]),e.isLoading?s("Spinner"):s("div",{staticClass:"active-users"},e._l(e.allUsers,(function(t){return s("div",{key:t.id,staticClass:"active-user"},[s("router-link",{attrs:{to:{name:"private-room",query:{id:t.id,room:""+t.id+e.currentUser.id}}}},[s("img",{attrs:{src:e._f("emptyImage")(t.avatar),alt:""}})]),s("p",{staticClass:"user-name"},[e._v(e._s(t.name))]),s("p",{staticClass:"user-id"},[e._v("@"+e._s(t.account))])],1)})),0)],1),s("div",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!0,smooth:!0},expression:"{\n        always: true,\n        smooth: true,\n      }"}],staticClass:"chat-room",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.makeUnreadPublicMessageZero.apply(null,arguments)}}},[s("ChatRoom")],1)])])},r=[],n=s("5530"),i=s("1da1"),c=(s("96cf"),s("c4cd")),o=s("8624"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat-room-wrapper"},[e._m(0),e.isLoading?a("Spinner"):a("div",[a("div",{attrs:{id:"chat-wrapper"}},[e._l(e.allMessages,(function(t,s){return a("div",{key:s,staticClass:"chat-wrapper"},[1===+t.type&&t.account!==e.currentUser.account?a("div",{staticClass:"online-box center"},[a("span",{staticClass:"online-text"},[e._v(e._s(t.name)+" 上線")])]):-1===+t.type&&t.account!==e.currentUser.account?a("div",{staticClass:"online-box center"},[a("span",{staticClass:"online-text"},[e._v(e._s(t.name)+" 下線")])]):e._e(),t.message&&t.account!==e.currentUser.account?a("div",{staticClass:"reply-box"},[a("div",{staticClass:"reply-text-info bottom-align"},[a("div",{staticClass:"user-info"},[a("img",{staticClass:"user-pic",attrs:{src:e._f("emptyImage")(t.avatar),alt:""}}),a("div",{staticClass:"user-name"},[e._v(e._s(t.name))])]),a("div",{staticClass:"reply-text-time"},[a("div",{staticClass:"reply-text"},[e._v(e._s(t.message&&t.message))])])]),a("p",{staticClass:"reply-time"},[e._v(e._s(e._f("fromNow")(t.createdAt)))])]):e._e(),t.message&&t.account===e.currentUser.account?a("div",{staticClass:"sent-box right"},[a("div",{staticClass:"sent-text"},[e._v(e._s(t.message))]),a("p",{staticClass:"sent-time"},[e._v(e._s(e._f("fromNow")(t.createdAt)))])]):e._e()])})),a("div",{staticClass:"chat-wrapper"},[a("div",{staticClass:"online-box center"},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.typing,expression:"typing"}],staticClass:"online-text"},[e._v("正在輸入訊息...")])])])],2),a("div",{staticClass:"chat-field"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.temp.message,expression:"temp.message"}],attrs:{type:"text",id:"sendtxt",placeholder:"輸入訊息..."},domProps:{value:e.temp.message},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.temp,"message",t.target.value)}}}),a("button",{staticClass:"sendBtn",on:{click:e.sendMessage}},[a("img",{attrs:{src:s("b6e6")}})])])])],1)},u=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header"},[s("div",{staticClass:"header-info"},[s("p",[e._v("公開聊天室")])])])}],d=(s("498a"),s("b0c0"),s("56d7")),m=s("cf21"),p=s("2f62"),h=s("5fad"),f=s("ac0d"),v=s("09e4"),g={name:"ChatRooom",components:{Spinner:m["a"]},mixins:[f["a"],f["c"],f["d"],f["f"]],sockets:{users:function(e){this.users=e},typing:function(){this.typing=!0},stopTyping:function(){this.typing=!1}},data:function(){return{isLoading:!0,ready:!1,typing:!1,userName:[],temp:{message:"",name:""},currentUser:{}}},methods:{sendMessage:function(e){e.target.focus(),this.temp.message.trim().length&&(this.temp.name=this.currentUser.account,d["default"].emit("message",this.formatMessage(this.temp.message,0,this.currentUser)),this.temp.message="",this.temp.name="",d["default"].emit("afterPublicMessageSend",this.currentUser.id))},fetchCurrentUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,h["a"].getCurrentUser();case 4:if(s=t.sent,a=s.data,r=s.statusText,"OK"===r){t.next=8;break}throw new Error(r);case 8:e.currentUser=Object(n["a"])({},a),e.isLoading=!1,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),e.isLoading=!1,v["a"].generalErrorHandler(t.t0)(e);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()}},created:function(){this.fetchCurrentUser()},computed:Object(n["a"])({},Object(p["d"])({allMessages:"allMessages",allUsers:"allUsers"})),watch:{temp:{handler:function(e){e.message?d["default"].emit("typing"):d["default"].emit("stopTyping")},deep:!0}}},C=g,w=(s("861e"),s("2877")),A=Object(w["a"])(C,l,u,!1,null,"39948547",null),b=A.exports,U={mixins:[f["a"]],components:{Spinner:m["a"],Sidebar:c["a"],NewTweetModal:o["a"],ChatRoom:b},beforeRouteLeave:function(e,t,s){d["default"].emit("leaved",this.currentUser),s()},data:function(){return{showModal:!1,showReplyModal:!1,isLoading:!0,currentUser:{}}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchCurrentUserAndEmitNewUser();case 2:e.makeUnreadPublicMessageZero();case 3:case"end":return t.stop()}}),t)})))()},computed:Object(n["a"])({},Object(p["d"])({allUsers:"allUsers"})),methods:{makeUnreadPublicMessageZero:function(){this.$store.dispatch("CLEAR_COMMUNITY_NOTIFICATION_UNREAD",{currentUserId:this.currentUser.id,types:["3"]}),d["default"].emit("afterReadPublicMessage",this.currentUser.id)},fetchCurrentUserAndEmitNewUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,h["a"].getCurrentUser();case 4:if(s=t.sent,a=s.data,r=s.statusText,"OK"===r){t.next=8;break}throw new Error(r);case 8:e.currentUser=Object(n["a"])({},a),e.newUser(),e.isLoading=!1,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),v["a"].generalErrorHandler(t.t0)(e);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},newUser:function(){d["default"].emit("user",Object(n["a"])({},this.currentUser))},modalToggle:function(){this.showModal?this.showModal=!1:this.showModal=!0},replyModalToggle:function(e){this.showReplyModal?(this.replyTweetId="",this.showReplyModal=!1):(this.replyTweetId=e,this.showReplyModal=!0)},clickButton:function(e){this.$socket.emit("emit_method",e)}}},y=U,x=(s("a4bc"),Object(w["a"])(y,a,r,!1,null,"17d09984",null));t["default"]=x.exports},c8d2:function(e,t,s){var a=s("5e77").PROPER,r=s("d039"),n=s("5899"),i="​᠎";e.exports=function(e){return r((function(){return!!n[e]()||i[e]()!==i||a&&n[e].name!==e}))}},cf21:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"spinner"},[s("div",{staticClass:"bouncing-loader"},[s("div"),s("div"),s("div")])])}],n={name:"Spinner"},i=n,c=(s("95fa"),s("2877")),o=Object(c["a"])(i,a,r,!1,null,"17e4c76d",null);t["a"]=o.exports}}]);
//# sourceMappingURL=chunk-69190b8e.a9ae3cc8.js.map