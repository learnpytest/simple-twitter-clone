(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7519f690"],{"2db7":function(e,t,a){},"3b9d":function(e,t,a){"use strict";a("5076")},5076:function(e,t,a){},"8b63":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tweets-wrapper"},e._l(e.tweets,(function(t,n){return s("div",{key:n,staticClass:"tweet",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),function(){return e.$router.push({name:"reply-list",params:{id:t.TweetId}})}.apply(null,arguments)}}},[s("div",{staticClass:"user-pic",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),function(){return e.$router.push({name:"user",params:{id:t.User.id}})}.apply(null,arguments)}}},[s("img",{attrs:{src:e._f("emptyImage")(t.User.avatar),alt:""}})]),s("div",{staticClass:"tweet-info"},[s("div",{staticClass:"info"},[s("p",{staticClass:"user-name"},[e._v(" "+e._s(t.User.name)+" "),s("span",{staticClass:"user-id"},[e._v("@"+e._s(t.User.account)+" • ")]),s("span",{staticClass:"time"},[e._v(e._s(e._f("fromNow")(t.createdAt)))])])]),s("div",{staticClass:"tweet-text"},[e._v(e._s(t.description))]),s("div",{staticClass:"tweet-buttons-control"},[s("div",{staticClass:"tweet-buttons"},[s("img",{attrs:{src:a("5482"),alt:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.handleShowModalClick(t.TweetId)}}}),s("p",{staticClass:"reply-num"},[e._v(e._s(t.RepliesCount))])]),s("div",{staticClass:"tweet-buttons"},[t.isLiked?s("img",{attrs:{id:"liked-btn",src:a("c92c"),alt:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.unLike(t.TweetId,t)}}}):s("img",{attrs:{src:a("5ead"),alt:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.addLike(t.TweetId,t)}}}),s("p",{staticClass:"liked-num",class:{liked:t.isLiked}},[e._v(" "+e._s(t.LikesCount)+" ")])])])])])})),0)},n=[],r=a("5530"),i=a("1da1"),o=a("2909"),c=(a("d81d"),a("a9e3"),a("a4d3"),a("e01a"),a("96cf"),a("5fad")),l=a("60e2"),u=a("ac0d"),d={mixins:[u["a"],u["d"],u["e"]],props:{initialTweets:{type:Array,required:!0},initialShowReplyModal:{type:Boolean}},data:function(){return{showReplyModal:!1,tweets:[],currentUser:{}}},watch:{initialTweets:function(e){this.tweets=Object(o["a"])(e)}},created:function(){this.fetchData(),this.fetchCurrentUser()},methods:{fetchData:function(){this.showReplyModal=this.initialShowReplyModal,this.tweets=this.initialTweets},fetchCurrentUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].getCurrentUser();case 2:a=t.sent,s=a.data,e.currentUser=Object(r["a"])({},s);case 5:case"end":return t.stop()}}),t)})))()},addLike:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,l["a"].postLike(e);case 3:if(n=s.sent,i=n.data,"success"===i.status){s.next=7;break}throw new Error(i.message);case 7:a.tweets=a.tweets.map((function(t){return t.TweetId===Number(e)?Object(r["a"])(Object(r["a"])({},t),{},{isLiked:!0,LikesCount:t.LikesCount+1}):Object(r["a"])({},t)})),a.socketSendCommunityOneNotification("1",a.currentUser,null,t.description,t.TweetId),s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](0),console.log("error",s.t0);case 14:case"end":return s.stop()}}),s,null,[[0,11]])})))()},unLike:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,l["a"].deleteLike(e);case 3:if(n=s.sent,i=n.data,"success"===i.status){s.next=7;break}throw new Error(i.message);case 7:a.tweets=a.tweets.map((function(t){return t.TweetId===Number(e)?Object(r["a"])(Object(r["a"])({},t),{},{isLiked:!1,LikesCount:t.LikesCount-1}):Object(r["a"])({},t)})),a.socketSendCommunityOneNotification("2",a.currentUser,null,t.description,t.TweetId),s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](0),console.log("error",s.t0);case 14:case"end":return s.stop()}}),s,null,[[0,11]])})))()},handleShowModalClick:function(e){this.showReplyModal=!0,this.$emit("show-reply-modal",e)}}},w=d,p=(a("9421"),a("2877")),h=Object(p["a"])(w,s,n,!1,null,"47ad2272",null);t["a"]=h.exports},"8c83":function(e,t,a){"use strict";a("2db7")},9421:function(e,t,a){"use strict";a("f46b")},f255:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[e.showModal?a("div",{staticClass:"new-tweet-modal"},[a("NewTweetModal",{attrs:{initialShowModal:e.showModal},on:{"show-modal":e.modalToggle,updateData:e.updateTweetsData}})],1):e._e(),e.showReplyModal?a("div",{staticClass:"new-tweet-modal"},[a("ReplyTweetModal",{attrs:{initialShowReplyModal:e.showReplyModal,initialTweetId:e.replyTweetId},on:{"show-reply-modal":e.replyModalToggle}})],1):e._e(),a("div",{staticClass:"usermain"},[a("div",{staticClass:"sidebar"},[a("Sidebar",{attrs:{initialShowModal:e.showModal},on:{"show-modal":e.modalToggle}})],1),a("div",{staticClass:"main"},[a("div",{staticClass:"addtweet"},[a("AddTweet",{attrs:{initialShowModal:e.showModal},on:{"show-modal":e.modalToggle}})],1),a("div",{staticClass:"tweets"},[a("Tweets",{attrs:{initialShowReplyModal:e.showReplyModal,initialTweets:e.userTweets},on:{"show-reply-modal":e.replyModalToggle}})],1)]),a("div",{staticClass:"popular"},[a("Popular")],1)])])},n=[],r=a("2909"),i=a("1da1"),o=(a("96cf"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addtweet-wrapper"},[a("div",{staticClass:"header"},[e._v("首頁")]),a("div",{staticClass:"text-box"},[a("div",{staticClass:"user-info"},[a("img",{staticClass:"user-pic",attrs:{src:e._f("emptyImage")(e.currentUser.avatar),alt:""}})]),a("div",{staticClass:"text-area",on:{click:e.handleShowModalClick}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],staticClass:"form-control",attrs:{rows:"3",placeholder:"有什麽新鮮事"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}})])]),e._m(0)])}),c=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tweet-btn"},[a("button",[e._v("推文")])])}],l=a("ac0d"),u=a("5fad"),d={mixins:[l["a"]],props:{initialShowModal:{type:Boolean,required:!0}},data:function(){return{showModal:"",text:"",currentUser:{}}},created:function(){this.fetchData(),this.getCurrentUser()},methods:{fetchData:function(){this.showModal=this.initialShowModal},handleShowModalClick:function(){this.showModal=!1,this.$emit("show-modal")},getCurrentUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].getCurrentUser();case 3:if(a=t.sent,s=a.data,n=a.statusText,"OK"===n){t.next=7;break}throw new Error(n);case 7:e.currentUser=s,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},w=d,p=(a("8c83"),a("2877")),h=Object(p["a"])(w,o,c,!1,null,"4fa82867",null),f=h.exports,m=a("8b63"),v=a("9a31"),g=a("c4cd"),C=a("8624"),b=a("0162"),k=a("6783"),M={components:{AddTweet:f,Tweets:m["a"],Popular:v["a"],Sidebar:g["a"],NewTweetModal:C["a"],ReplyTweetModal:b["a"]},data:function(){return{showModal:!1,showReplyModal:!1,userTweets:[],replyTweetId:""}},created:function(){this.getTweets()},methods:{updateTweetsData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTweets();case 2:case"end":return t.stop()}}),t)})))()},modalToggle:function(){this.showModal?this.showModal=!1:this.showModal=!0},getTweets:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k["a"].getAllTweet();case 3:a=t.sent,s=a.data,e.userTweets=Object(r["a"])(s),e.showModal=!1,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},replyModalToggle:function(e){this.showReplyModal?(this.replyTweetId="",this.showReplyModal=!1):(this.replyTweetId=e,this.showReplyModal=!0)}}},T=M,y=(a("3b9d"),Object(p["a"])(T,s,n,!1,null,"ef83e47e",null));t["default"]=y.exports},f46b:function(e,t,a){}}]);
//# sourceMappingURL=chunk-7519f690.1eb5d330.js.map